(title "expect <bool>")

(expect:error
    "\(expect\) invalid type: true"
    (fn (shield:validate null (shield:model (rules expect "true" ))))
    "expect invalid type"
)

(expect:error
    "@messages.expect:obj"
    (fn (shield:validate (null) (shield:model (rules expect "object"))))
    "expect fails for object"
)
(expect:error
    "@messages.expect:obj"
    (fn (shield:validate (null) (shield:model (rules expect "obj"))))
    "expect fails for obj"
)
(expect:error
    "@messages.expect:array"
    (fn (shield:validate (null) (shield:model (rules expect "array"))))
    "expect fails for array"
)
(expect:error
    "@messages.expect:bool"
    (fn (shield:validate (null) (shield:model (rules expect "boolean"))))
    "expect fails for boolean"
)
(expect:error
    "@messages.expect:bool"
    (fn (shield:validate (null) (shield:model (rules expect "bool"))))
    "expect fails for bool"
)
(expect:error
    "@messages.expect:int"
    (fn (shield:validate (null) (shield:model (rules expect "integer"))))
    "expect fails for integer"
)
(expect:error
    "@messages.expect:int"
    (fn (shield:validate (null) (shield:model (rules expect "int"))))
    "expect fails for int"
)
(expect:error
    "@messages.expect:float"
    (fn (shield:validate (null) (shield:model (rules expect "float"))))
    "expect fails for float"
)
(expect:error
    "@messages.expect:str"
    (fn (shield:validate (null) (shield:model (rules expect "string"))))
    "expect fails for string"
)
(expect:error
    "@messages.expect:str"
    (fn (shield:validate (null) (shield:model (rules expect "str"))))
    "expect fails for str"
)
(expect:error
    "@messages.expect:null"
    (fn (shield:validate ('xx') (shield:model (rules expect "null"))))
    "expect fails for null"
)


(expect:eq
    (data_obj)
    (shield:validate (data_obj)   (shield:model (rules expect "object")))
    "expect successful for object"
)
(expect:eq
    (data_obj)
    (shield:validate (data_obj)   (shield:model (rules expect "obj")))
    "expect successful for obj"
)
(expect:eq
    (data_array)
    (shield:validate (data_array) (shield:model (rules expect "array")))
    "expect successful for array"
)
(expect:eq
    (data_array)
    (shield:validate (data_array) (shield:model (rules expect "array")))
    "expect successful for array"
)
(expect:eq
    (data_bool)
    (shield:validate (data_bool)  (shield:model (rules expect "boolean")))
    "expect successful for boolean"
)
(expect:eq
    (data_bool)
    (shield:validate (data_bool)  (shield:model (rules expect "bool")))
    "expect successful for bool"
)
(expect:eq
    (data_int)
    (shield:validate (data_int)   (shield:model (rules expect "integer")))
    "expect successful for integer"
)
(expect:eq
    (data_int)
    (shield:validate (data_int)   (shield:model (rules expect "int")))
    "expect successful for int"
)
(expect:eq
    (data_float)
    (shield:validate (data_float) (shield:model (rules expect "float")))
    "expect successful for float"
)
(expect:eq
    (data_str)
    (shield:validate (data_str)   (shield:model (rules expect "string")))
    "expect successful for string"
)
(expect:eq
    (data_str)
    (shield:validate (data_str)   (shield:model (rules expect "str")))
    "expect successful for str"
)
(expect:eq
    (data_null)
    (shield:validate (data_null)  (shield:model (rules expect "null")))
    "expect successful for null"
)
